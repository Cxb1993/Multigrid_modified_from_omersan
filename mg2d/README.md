Slight changes to the original code
