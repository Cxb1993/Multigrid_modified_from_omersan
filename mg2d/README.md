Slight changed to the original code
